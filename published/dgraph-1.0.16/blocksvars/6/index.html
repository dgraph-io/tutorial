



<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.53" />
    <meta name="description" content="">


    <link rel="apple-touch-icon" sizes="57x57" href="https://tour.dgraph.io/dgraph-1.0.16/images/favicons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="https://tour.dgraph.io/dgraph-1.0.16/images/favicons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="https://tour.dgraph.io/dgraph-1.0.16/images/favicons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="https://tour.dgraph.io/dgraph-1.0.16/images/favicons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="https://tour.dgraph.io/dgraph-1.0.16/images/favicons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="https://tour.dgraph.io/dgraph-1.0.16/images/favicons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="https://tour.dgraph.io/dgraph-1.0.16/images/favicons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="https://tour.dgraph.io/dgraph-1.0.16/images/favicons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://tour.dgraph.io/dgraph-1.0.16/images/favicons/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="https://tour.dgraph.io/dgraph-1.0.16/images/favicons/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://tour.dgraph.io/dgraph-1.0.16/images/favicons/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="https://tour.dgraph.io/dgraph-1.0.16/images/favicons/favicon-194x194.png" sizes="194x194">
    <link rel="icon" type="image/png" href="https://tour.dgraph.io/dgraph-1.0.16/images/favicons/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="https://tour.dgraph.io/dgraph-1.0.16/images/favicons/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="https://tour.dgraph.io/dgraph-1.0.16/images/favicons/manifest.json">
    <link rel="mask-icon" href="https://tour.dgraph.io/dgraph-1.0.16/images/favicons/safari-pinned-tab.svg" color="#fe2c06">
    <link rel="shortcut icon" href="https://tour.dgraph.io/dgraph-1.0.16/images/favicons/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-TileImage" content="https://tour.dgraph.io/dgraph-1.0.16/images/favicons/mstile-144x144.png">
    <meta name="msapplication-config" content="https://tour.dgraph.io/dgraph-1.0.16/images/favicons/browserconfig.xml">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/highlight.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/languages/go.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.10.0/languages/java.min.js" integrity="sha256-RyOs5MjQ+Ef9DQrPHp4QGr2tcNjxLh6mCkkW+sS4doU=" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous" />


    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/codemirror.js" integrity="sha256-x3BtPVERvw1ozPlwivuFLZoViFCeAAs1Gt6SxEedmo8=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/codemirror.css" integrity="sha256-7sZe9dsqyNZC9Mk+WPRB7nVvPPPXyorzm2QKqlgXC4k=" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/addon/edit/closebrackets.min.js" integrity="sha256-qhu2a7DSpQaammMaLw1iruxBpxmgdw8mdQaQWQUokcY=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/mode/javascript/javascript.min.js" integrity="sha256-7Bdg/UdDMmHDPafpQDYZNPCEbnRP7eAvu+2hEoqRCXs=" crossorigin="anonymous"></script>
    

    <script>
    if (window.location.href.indexOf("dgraph.io") > -1) {
  (function(i, s, o, g, r, a, m) {
    i["GoogleAnalyticsObject"] = r;
    (i[r] =
      i[r] ||
      function() {
        (i[r].q = i[r].q || []).push(arguments);
      }), (i[r].l = 1 * new Date());
    (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m);
  })(
    window,
    document,
    "script",
    "https://www.google-analytics.com/analytics.js",
    "ga"
  );

  ga("create", "UA-75364122-2", "auto");
  ga("send", "pageview");
}
</script>

    
    <title>
      
        Exercise: Query Variables linking queries â€” A Tour of Dgraph
      
    </title>

    <link href="https://tour.dgraph.io/dgraph-1.0.16/css/theme.css?d9869d427652dce3acfcac0db59fc1aa" rel="stylesheet" />
    <link href="https://tour.dgraph.io/dgraph-1.0.16/css/runnable.css?2aa73e4077d475dc8e9b8d61e4ea5a62" rel="stylesheet" />
    <link href="https://tour.dgraph.io/dgraph-1.0.16/css/runnable-custom.css?fd581e09310956d9e7e07a71e2d31145" rel="stylesheet" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <link href="https://fonts.googleapis.com/css?family=Lato:400,700" rel="stylesheet" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous" />
  </head>
  <body>
    <main>


<nav id="header">
  <a href="https://tour.dgraph.io/dgraph-1.0.16" class="brand">
    <img src="https://tour.dgraph.io/dgraph-1.0.16/images/dgraph.svg" alt="dgraph" class="logo" />
    <span class="name">
      A Tour of Dgraph
    </span>
  </a>
  <select id="tour-release" class="select-release">
      
        <option
          value="master"
          
        >
          Dgraph master
        </option>
      
        <option
          value="1.0.16"
          
            selected="selected"
          
        >
          Dgraph 1.0.16
        </option>
      
  </select>

  <div class="menus">
    <a href="#toggle-sidebar" data-action="toggle-sidebar" class="menu-item">
      <i class="fa fa-bars"></i>
    </a>
  </div>
</nav>

<script>
  window.DgTour = {
    thisRelease: "1.0.16",
    latestRelease: "1.0.16"
  }
</script>

<script>
  $('#tour-release').change(function(e) {
    var dest = e.target.value;
    if (dest == DgTour.thisRelease) {
      return
    }
    if (dest == DgTour.latestRelease) {
      window.location.href = "/"
      return
    }
    if (dest != "master") {
      dest = "dgraph-" + dest
    }
    window.location.href = "/" + dest
  })
</script>




<aside id="sidebar" class="hidden">
  
  <ul class="categories">
    <li>
      <div class="category">
        Introduction
      </div>


      <ul class="topics">
        
        
          <li>
            <a href="/dgraph-1.0.16/intro/1/" class="topic">
              Welcome
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/intro/2/" class="topic">
              Run Dgraph
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/intro/3/" class="topic">
              Load Schema
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/intro/4/" class="topic">
              Load Data
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/intro/5/" class="topic">
              Mutation Introduction
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/intro/6/" class="topic">
              Graphs
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/intro/7/" class="topic">
              Graph Databases
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/intro/8/" class="topic">
              Congratulations
            </a>
          </li>
        
      </ul>
    </li>
  
  <ul class="categories">
    <li>
      <div class="category">
        Basic GraphQL&#43;- features
      </div>


      <ul class="topics">
        
        
          <li>
            <a href="/dgraph-1.0.16/basic/1/" class="topic">
              Hello World
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/basic/2/" class="topic">
              Graphs as results
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/basic/3/" class="topic">
              Data types and Schema
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/basic/4/" class="topic">
              Language Support
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/basic/5/" class="topic">
              Queries describe graphs
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/basic/6/" class="topic">
              Functions and filtering
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/basic/7/" class="topic">
              AND, OR and NOT
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/basic/8/" class="topic">
              Sorting (orderasc or orderdesc)
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/basic/9/" class="topic">
              Pagination (first, offset and after)
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/basic/10/" class="topic">
              Count
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/basic/11/" class="topic">
              How Dgraph Search Works
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/basic/12/" class="topic">
              Has
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/basic/13/" class="topic">
              Alias
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/basic/14/" class="topic">
              Cascade
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/basic/15/" class="topic">
              Normalize
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/basic/16/" class="topic">
              Comments
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/basic/17/" class="topic">
              Facets : Edge attributes
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/basic/18/" class="topic">
              Congratulations
            </a>
          </li>
        
      </ul>
    </li>
  
  <ul class="categories">
    <li>
      <div class="category">
        Schema - describe your data
      </div>


      <ul class="topics">
        
        
          <li>
            <a href="/dgraph-1.0.16/schema/1/" class="topic">
              Adding schema - mutating schema
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/schema/2/" class="topic">
              Adding Data - mutating data
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/schema/3/" class="topic">
              External Identifiers
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/schema/4/" class="topic">
              Language Support
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/schema/5/" class="topic">
              Reverse edges
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/schema/6/" class="topic">
              Exercise : Integrating existing data
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/schema/7/" class="topic">
              Deleting Data
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/schema/8/" class="topic">
              Predicate Query
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/schema/9/" class="topic">
              Expand Predicate
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/schema/10/" class="topic">
              Congratulations
            </a>
          </li>
        
      </ul>
    </li>
  
  <ul class="categories">
    <li>
      <div class="category">
        Data, More Data
      </div>


      <ul class="topics">
        
        
          <li>
            <a href="/dgraph-1.0.16/moredata/1/" class="topic">
              A bigger dataset
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/moredata/2/" class="topic">
              Movies Schema
            </a>
          </li>
        
      </ul>
    </li>
  
  <ul class="categories">
    <li>
      <div class="category">
        Query Blocks, Query Variables and Aggregation
      </div>


      <ul class="topics">
        
        
          <li>
            <a href="/dgraph-1.0.16/blocksvars/1/" class="topic">
              Multiple Named Query Blocks
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/blocksvars/2/" class="topic">
              Query Variables
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/blocksvars/3/" class="topic">
              Query Variables in a child block
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/blocksvars/4/" class="topic">
              Query Variables in another query block I
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/blocksvars/5/" class="topic">
              Query Variables in another query block II
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/blocksvars/6/" class="topic active">
              Exercise: Query Variables linking queries
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/blocksvars/7/" class="topic">
              Value variables - min and max
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/blocksvars/8/" class="topic">
              Exercise : Value variables - sum and avg
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/blocksvars/9/" class="topic">
              Value variables: filtering and ordering
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/blocksvars/10/" class="topic">
              Value variables: math functions
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/blocksvars/11/" class="topic">
              Exercise : Latest Movies
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/blocksvars/12/" class="topic">
              GroupBy
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/blocksvars/13/" class="topic">
              expand and _predicate_
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/blocksvars/14/" class="topic">
              Congratulations!
            </a>
          </li>
        
      </ul>
    </li>
  
  <ul class="categories">
    <li>
      <div class="category">
        Search - more ways to find nodes
      </div>


      <ul class="topics">
        
        
          <li>
            <a href="/dgraph-1.0.16/search/1/" class="topic">
              Indexes
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/search/2/" class="topic">
              Term search
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/search/3/" class="topic">
              Regular Expressions
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/search/4/" class="topic">
              Exact index and inequality
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/search/5/" class="topic">
              Full Text Search
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/search/6/" class="topic">
              Full Text Search : language support
            </a>
          </li>
        
          <li>
            <a href="/dgraph-1.0.16/search/7/" class="topic">
              Geo queries : Near
            </a>
          </li>
        
      </ul>
    </li>
  
</aside>

<div class="lesson-content-wrapper container-fluid">
  <div class="content row vertical-stretch">
    <div class="col-12 col-sm-12 col-md-12 col-lg-6 vertical-stretch">
      <div class="panel">
        <div class="body">
          <h1 class="lesson-heading">Exercise: Query Variables linking queries</h1>

          <div>
            <p>We&rsquo;ve seen two common uses for variables: filtering and reorganizing results.  Another is linking two queries to gain some new insight based on the joined results.</p>

<p>Let&rsquo;s look at an example of joining two queries.</p>

<p>For two directors find the actors who have worked with both (not
necessarily on the same movie).  Many directors won&rsquo;t have actors in
common, so start with some you are sure will (the answer below uses
Peter Jackson and Martin Scorsese who have a small number of actors in
common).</p>

<p>As an optional challenge, for each
of those actors list the movies they have made with either director.</p>

<div class="expandable">
  <a data-action="toggle-expandable" href="#expand">
    <i class="fa fa-caret-down"></i> Show answer
  </a>
  <div class="expandable-content">
    <pre><code>{
  var(func: allofterms(name@en, &quot;Peter Jackson&quot;)) {
    F_PJ as director.film {
      starring{
        A_PJ as performance.actor
      }
    }
  }

   var(func: allofterms(name@en, &quot;Martin Scorsese&quot;)) {
    F_MS as director.film {
      starring{
        A_MS as performance.actor
      }
    }
  }

  actors(func: uid(A_PJ)) @filter(uid(A_MS)) @cascade {
    actor: name@en
    actor.film {
      performance.film @filter (uid(F_PJ, F_MS)) {
      	name@en
      }
    }
  }
}
</code></pre>

<p>The syntax <code>uid(F_PJ, F_MS)</code> means the UIDs in both <code>F_PJ</code> and <code>F_MS</code> and is equivalent to <code>uid(F_PJ) OR uid(F_MS)</code>.</p>

  </div>
</div>


          </div>
        </div>

        <div class="page-nav">
          
            <a href="/dgraph-1.0.16/blocksvars/5" data-action="go-prev" class="btn btn-secondary btn-sm page-nav-link"><i class="fa fa-chevron-left"></i></a>
          
          <div class="nav-index">
            6 / 14
          </div>
          
            <a href="/dgraph-1.0.16/blocksvars/7" data-action="go-next" class="btn btn-secondary btn-sm page-nav-link"><i class="fa fa-chevron-right"></i></a>
          
        </div>
      </div>
    </div>

    <div class="col-12 col-sm-12 col-md-12 col-lg-6 vertical-stretch">
      
        
<div class="runnable" data-initial="{
	# some hints for your query

	# find the movies and actors for each director
	# and store those in variables

	# then join them up in a third query
}
" data-current="{
	# some hints for your query

	# find the movies and actors for each director
	# and store those in variables

	# then join them up in a third query
}
" endpoint="/query" data-dirty="false">
  <div class="runnable-pane runnable-pane-query">
    <div class="topbar">
      <div class="row">
        <div class="col-7">
          <span class="pane-title">
            Endpoint: /query
          </span>
        </div>
        <div class="col-5">
          <div class="actions pull-right">
            <a class="code-btn" data-action="reset" href="#">Reset</a>
            <a class="code-btn" data-action="run" href="#">Run</a>
          </div>
        </div>
      </div>
    </div>

    <div class="runnable-content runnable-code">
      <div class="runnable-tab-content active">
        <textarea class="query-content-editable">{
	# some hints for your query

	# find the movies and actors for each director
	# and store those in variables

	# then join them up in a third query
}
</textarea>
      </div>
    </div>

    <div class="row footer">
      <div class="col-12">
        <div class="actions pull-right">

        </div>
      </div>
    </div>
  </div>

  <div class="runnable-pane runnable-pane-output">
    <div class="row topbar">
      <div class="col-12">
        <span class="pane-title">
          Response
        </span>
      </div>
    </div>

    <div class="runnable-content runnable-output" style="background: url('https://tour.dgraph.io/dgraph-1.0.16/images/dgraph-black.png'); background-repeat: no-repeat; background-position: center; background-color: #fff;">
      <pre class="output-container empty"><code class="output" tabindex="-1"></code></pre>
    </div>

    <div class="row footer">
      <div class="col-12 col-sm-8">
        <div class="latency-info hidden">
          <div class="stat server-latency">
            <span class="label">Server latency:</span> <span class="number"></span> <i class="fa fa-question-circle server-latency-tooltip-trigger" data-toggle="tooltip" data-placement="top" data-html="true" title="Latency information" data-animation="false"></i>
          </div>
          <div class="stat network-latency">
            <span class="label">Network latency:</span> <span class="number"></span>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

      
    </div>
  </div>
</div>

    </main>

    <script src="https://tour.dgraph.io/dgraph-1.0.16/js/clipboard.min.js"></script>
    <script src="https://tour.dgraph.io/dgraph-1.0.16/js/dgraph.js?c58da7a713c2e172f9af43e595b9c7a9"></script>
    <script src="https://tour.dgraph.io/dgraph-1.0.16/js/runnable.js?87803fe503e1bb4355cc2c8bcb680842"></script>
    <script>
      hljs.initHighlightingOnLoad();
    </script>
  </body>
</html>

